!function(c,l){"use strict";l("#customize-theme-controls").addClass("cs-customizer-wrapper"),c.cozystay=c.cozystay||{},c.cozystay.controls=c.cozystay.controls||{};var i="cozystay_site_layout";function d(e){var t=typeof e;return"function"==t||"object"==t&&e}function o(){var r=c.settings.settings,s={},e=l.extend({},c.settings.controls,c.cozystay.controls);l.each(e,function(i,o){var e,t,a=(e=(t=o).settings,t=Object.keys(e),!!(t="default"in e?"default":!!t.length&&t[0])&&e[t]);a&&r[a]&&r[a].dependency&&(t=function n(e,i){return d(e)&&(e.is_complex?l.each(e,function(e,t){d(t)&&(i=n(t,i))}):l.each(e,function(e,t){e in i||i.push(e)})),i}(r[a].dependency,[]),l.each(t,function(e,t){var n={control:c.control(i)||o,dependency:r[a].dependency};t in s?s[t].push(n):c(t)&&(s[t]=[n],c(t).bind(function(e){c.trigger("change.cozystay.customizer",t)}))}))}),c.cozystay.dependency=s}function a(e){if(d(e)){var t="AND";return e.relation&&(t=e.relation?e.relation.toUpperCase():"AND"),("AND"==t?function(e,n){if(!d(e))return!0;var i=!0;return l.each(e,function(e,t){if(d(t)&&!(n?a(t):r(e,t)))return i=!1}),i}:function(e,n){if(!d(e))return!0;var i=!1;return l.each(e,function(e,t){if(d(t)&&(n?a(t):r(e,t)))return!(i=!0)}),i})(e,e.is_complex||!1)}return!0}function r(e,t){if(!e||!t||!t.value)return!1;var n=t.operator||"in",e=function(e){if(e in c.settings.settings){e=c.get()[e];return!0===e?"on":e}}(e);return"in"===n?-1!==t.value.indexOf(e):-1===t.value.indexOf(e)}c.bind("change.cozystay.customizer",function(e){e in c.cozystay.dependency&&l.each(c.cozystay.dependency[e],function(e,t){var n=t.control.container;a(t.dependency)?n.show():n.hide()})}),c.controlConstructor.number_slider=c.Control.extend({ready:function(){var e=this.container.find(".loader-ui-slider"),n=this.container.find("input[data-customize-setting-link]");e.slider({range:"min",min:e.data("min"),max:e.data("max"),value:e.data("value"),step:e.data("step"),slide:function(e,t){n.val(t.value).trigger("change")}})}}),c.controlConstructor.number=c.controlConstructor.number_with_unit=c.Control.extend({ready:function(){var o=this.id;this.container.find("input[type=number]").on("change",function(e){var t=l(this),n=parseInt(t.val(),10),i=parseInt(t.attr("min"),10),t=parseInt(t.attr("max"),10),i=isNaN(i)?Number.MIN_SAFE_INTEGER:i,t=isNaN(t)?Number.MAX_SAFE_INTEGER:t;""===n||n<i?c(o)(i):!1===t||n<t||c(o)(t)})}}),c.controlConstructor.image_id=c.Control.extend({ready:function(){l(this.container).on("click",".cs-customize-upload-image, .attachment-thumb",function(e){e.preventDefault(),cozystayMeida.open(l(this).parent().siblings("input[type=hidden]").first())}).on("click",".cs-customize-remove-image",function(e){e.preventDefault();e=l(this).parent();l(this).addClass("hide"),e.siblings("input[type=hidden]").first().val("").trigger("change"),e.siblings(".placeholder").removeClass("hide"),e.siblings(".thumbnail-image").remove(),e.parent().removeClass("attachment-media-view-image")}).on("changed.cozystay.media","input[type=hidden]",function(e,t){var n;e.preventDefault(),t&&"image"==t.type&&(n=l(this).closest(".attachment-media-view").addClass("attachment-media-view-image"),e=t.sizes&&(t.sizes.medium||t.sizes.thumbnail)||t,e=l("<div>",{class:"thumbnail thumbnail-image"}).append(l("<img>",{class:"attachment-thumb",src:e.url}).attr("width",e.width).attr("height",e.height)),n.children(".thumbnail-image").remove(),n.children(".placeholder").addClass("hide").after(e),n.find(".cs-customize-remove-image").removeClass("hide"),l(this).val(t.id).trigger("change"))})}}),c.controlConstructor.multiple_selection=c.Control.extend({ready:function(){var e=l(this.container).find("select[multiple]");e.length&&e.children('[value=""]').length&&(e.on("change",function(e){var t=l(this).children();1<t.filter(":selected").length&&t.filter('[value=""]').removeAttr("selected")}),e.trigger("change"))}}),c.controlConstructor.select_sortable=c.Control.extend({ready:function(){var e=l(this.container).find(".sortable-selection-value"),i=e.siblings(".sortable-selection-list"),o=e.siblings(".sortable"),a=this.id,e=c(a)();e&&(e=e.split(","),Array.isArray(e)&&l.each(e,function(e,t){var n=i.find('[value="'+t+'"]');n.length&&(n.hide(),o.append(l("<li>",{"data-id":t}).append(l("<span>",{class:"label"}).append(n.html())).append(l("<a>",{text:"x",class:"action-remove",href:"#"}))))})),o.on("value.update",function(){var e=[];l(this).children().each(function(){l(this).attr("data-id")&&e.push(l(this).attr("data-id"))}),c(a)(e.join(","))}).sortable({stop:function(e,t){l(this).trigger("value.update")}}),o.on("click","a",function(e){e.preventDefault();e=l(this).parent();i.find('[value="'+e.attr("data-id")+'"]').show(),e.remove(),o.sortable("refresh"),o.trigger("value.update")}),i.children().on("click",function(e){e.preventDefault();var t=l(this),n=t.attr("value"),e=c(a)();o.append(l("<li>",{"data-id":n}).append(l("<span>",{class:"label"}).append(t.html())).append(l("<a>",{text:"x",class:"action-remove",href:"#"}))),t.hide(),o.sortable("refresh"),c(a)(e?e+","+n:n)})}}),c.controlConstructor.mce_editor=c.Control.extend({ready:function(){var e=this.id,t=cozystayCustomizer&&cozystayCustomizer.editor_ids&&-1!=cozystayCustomizer.editor_ids.indexOf(e),n=tinyMCEPreInit&&tinyMCEPreInit.mceInit&&e in tinyMCEPreInit.mceInit&&window.tinymce,i=tinyMCEPreInit&&tinyMCEPreInit.qtInit&&e in tinyMCEPreInit.qtInit&&quicktags;t&&n&&i&&(i=l(this.container),cozystayInitEditor(e,{mce:tinyMCEPreInit.mceInit[e],qt:tinyMCEPreInit.qtInit[e]},i),window.wpActiveEditor=e)}}),c.controlConstructor.button=c.Control.extend({ready:function(e){c.Control.prototype.ready.apply(this,arguments);var n=cozystayCustomizer.sync_message||{sending:"Data is syncing. Please wait. It can take a couple of minutes.",done:"Congratulations! Sync is completed.",fail:"Sorry but unable to sync. Please try again later."},t=l(this.container),i=t.find(".customize-control-notifications-container");t.find("input[type=button]").on("click",function(e){e.preventDefault();var t=l(this);i.css("display","none"),t.attr("action")&&t.attr("nonce")&&(t.attr("disabled","disabled"),i.css("display","").children().html("<li>"+n.sending+"</li>"),wp.ajax.post(t.attr("action"),{nonce:t.attr("nonce")}).done(function(e){i.css("display","").children().html("<li>"+n.done+"</li>")}).fail(function(e){i.css("display","").children().html("<li>"+n.fail+"</li>")}).always(function(){t.removeAttr("disabled")}))})}}),c.controlConstructor.group=c.Control.extend({ready:function(){var i;this.params.children&&(i=this.container.find("ul.group-controls-wrap"),l.each(this.params.children,function(e,t){var n=new((c.controlConstructor[t.type]||c.Control).extend({embed:function(){var t=this,e=function(e){c.section(e,function(e){e.deferred.embedded.done(function(){i.append(t.container),t.renderContent(),t.deferred.embedded.resolve()})})};t.section.bind(e),e(t.section.get())}}))(e,_.extend({params:t},t));c.cozystay.controls[e]=l.extend({container:n.container},t)}))}}),c.cozystay.site_layout=c.Control.extend({initialize:function(e,t){var n=this;n.params={},l.extend(n,t||{}),n.id=e,(e=l.map(n.params.settings,function(e){return e})).length?c.apply(c,e.concat(function(){for(var e in n.settings={},n.params.settings)n.settings[e]=c(n.params.settings[e]);n.setting=n.settings.default||null})):(n.setting=null,n.settings={}),n.ready()},ready:function(){var t=this;t.setting&&(t.setting.bind(function(e){t.settingChanged(e,t)}),t.settingChanged(t.setting(),t),c.trigger("change.cozystay.customizer",t.id))},settingChanged:function(e,n){e in cozystayCustomizer&&l.each(cozystayCustomizer[e],function(e,t){n.updateControlTitle(e,t)})},updateControlTitle:function(e,t){var e=c.control(e),n=!!e&&l(e.container);if(n&&e.params.type)switch(e.params.type){case"title_only":n.find("h3").text(t);break;case"checkbox":var i=n.children("label");i.length&&i.text(t);break;default:i=n.find(".customize-control-title");i.length&&i.text(t)}}}),c.bind("ready",function(e){var t;function n(e){var t=c.previewer.previewUrl();void 0!==e&&e&&t!=e&&c.previewer.previewUrl.set(e)}l("#customize-control-header_image .customizer-section-intro").html(cozystayCustomizer.header_description),l("#customize-control-header_image .current .customize-control-title").html(cozystayCustomizer.header_label),o(),i in c.settings.controls&&new c.cozystay.site_layout(i,{params:c.settings.controls[i]}),l("[data-customize-setting-link=cozystay_site_header_show_shop_cart]").length&&(t=l("[data-customize-setting-link=cozystay_site_header_show_mobile_cart_icon]").parent(),c("cozystay_site_header_show_shop_cart").bind(function(e){e?t.show():t.hide()}),c("cozystay_site_header_show_shop_cart")()?t.show():t.hide()),l("body").on("click","a.show-control",function(e){e.preventDefault();e=l(this).data("control-id");e&&c.previewer.trigger("focus-control-for-setting",e)}).on("click","a.show-panel, a.show-section",function(e){e.preventDefault();var t=l(this).data("section-id"),e=l(".control-section.open .customize-section-back");t&&l("#"+t).length&&(e.length&&e.trigger("click"),l("#"+t).find(".accordion-section-title").trigger("click"))}).on("click","a.redirect-preview-url",function(e){e.preventDefault();var t=l(this).attr("href");l(this).hasClass("static-home")&&(t=(e=!!c.get().page_for_posts&&c.get().page_for_posts)?"?page_id="+e:""),t&&"#"!=t&&n(c.settings.url.home+t)}).on("click","#accordion-section-cozystay_general_section_404_page",function(e){n(cozystayCustomizer.errorURL)}).on("click","#sub-accordion-section-cozystay_general_section_404_page .customize-section-back",function(e){c.previewer&&n(cozystayCustomizer.homeURL)}).on("click","#accordion-section-cozystay_general_section_popup_box",function(e){var t;c("cozystay_general_popup_box_enable")()&&c.previewer&&c.previewer.targetWindow()&&((t=l(".cs-popup.cs-popup-box",c.previewer.targetWindow().document)).length&&t.addClass("show"))}).on("click","#sub-accordion-section-cozystay_general_section_popup_box .customize-section-back",function(e){var t;c.previewer&&c.previewer.targetWindow()&&c.previewer.targetWindow().document&&((t=l(".cs-popup.cs-popup-box",c.previewer.targetWindow().document)).length&&t.removeClass("show"))}).on("click","#accordion-section-cozystay_site_header_section_mobile_menu",function(e){var t;c.previewer&&c.previewer.targetWindow()&&c.previewer.targetWindow().document&&((t=l(".sidemenu",c.previewer.targetWindow().document)).length&&!t.hasClass("show")&&t.addClass("show"))}).on("click","#sub-accordion-section-cozystay_site_header_section_mobile_menu .customize-section-back",function(e){var t,n;c.previewer&&c.previewer.targetWindow()&&c.previewer.targetWindow().document&&((n=(t=l(".sidemenu",c.previewer.targetWindow().document)).find(".close-button")).length&&t.length&&t.hasClass("show")&&n.trigger("click"))}),l(document).on("keyup",function(e){27!==e.keyCode||(e=l(".cs-popup.cs-popup-box",c.previewer.targetWindow().document)).length&&e.removeClass("show")})})}(wp.customize,jQuery);
