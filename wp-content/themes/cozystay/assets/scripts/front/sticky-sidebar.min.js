!function(s){"use strict";var d=s(window),t=s("body"),i=s(document),e=s("#page"),o=s(".site-header"),a={},a={isSticky:!1,primary:!1,secondary:!1,container:!1,mainContent:!1,upThreshholdSet:!1,downThresholdSet:!1,sidebarMarginTop:"",sidebarMarginBotton:"",sidebarHeight:"",primaryHeight:"",delta:"",previousAction:"",thresholdMax:"",thresholdMin:"",init:function(){var e=this;e.primary=s("#primary"),e.secondary=s("#secondary"),e.container=s("#secondary .sidebar-container"),e.mainContent=s("#content"),e.container.length&&e.container.find(".widget").length&&e.primary.length&&"on"===e.secondary.attr("data-enable-sticky-sidebar")&&(s("ins.adsbygoogle").length&&t.fixGoogleAdsenseInlineStyles(),d.one("load",function(){e.resize(),s(".main img, .main iframe").each(function(){e.observeElementLoaded(this)}),e.observeDOMChanges(s(".main"))}),i.on("scrolling.cozystay.window",function(t,i){e.recalculate(i.top,e.getStickySidebarOffset(),i.goUp)}).on("resize.cozystay.window loftocean.facebook.rendered ajaxSuccess",function(){e.resize(),e.runFixSidebar()}).on("changed.cozystay.mainContent",function(){e.resize()}))},observeElementLoaded:function(t){var i;s(t).length&&(i=this,s(t).one("load",function(){i.resize()}))},observeDOMChanges:function(t){var e;s(t).length&&(e=this,t=s(t).get(0),new MutationObserver(function(t,i){t.forEach(function(t){"childList"!==t.type||(t=["IMG","IFRAME"].includes(t.target.tagName)?s(t.target):s(t.target).find("img, iframe")).length&&t.each(function(){e.observeElementLoaded(this)})})}).observe(t,{attributes:!1,childList:!0,subtree:!0}))},resize:function(){this.sidebarMarginTop=parseFloat(this.secondary.css("margin-top")),this.sidebarPaddingBottom=parseFloat(this.secondary.css("padding-bottom")),this.primaryHeight=this.primary.height(),this.sidebarHeight=this.secondary.hasClass("sidebar-sticky")?this.container.outerHeight(!0,!0)+this.sidebarPaddingBottom:this.secondary.outerHeight(!0,!0)-this.sidebarMarginTop,this.delta=this.primaryHeight-this.sidebarHeight,this.isSticky=this.testSticky()},testSticky:function(){return this.primary.outerWidth(!0,!0)<this.primary.parent().width()&&this.delta>this.sidebarMarginTop},getStickySidebarOffset:function(){return o.length&&o.data("sticky-threhhold")&&"always-enable"==o.data("sticky-status")?o.data("sticky-threhhold"):cozystayParseInt(e.offset().top+50)},runFixSidebar:function(){var t,i,e,s,o,a,n,r,h,c;this.isSticky&&"fixed"!=this.container.css("position")?"static"==this.container.css("position")?this.recalculate(d.scrollTop(),this.getStickySidebarOffset(),!1):(t=this,i=!1,h=c=r=e="",s=d.scrollTop(),o=t.primary.offset().top,n=parseFloat(t.sidebarHeight),a=parseFloat(t.primaryHeight),t.sidebarHeight>cozystayInnerHeight?this.downThresholdSet||(h=(r=o-cozystayInnerHeight)+a,(c=r+n)<=s&&s<=h?(e=s-t.sidebarHeight+cozystayInnerHeight-o,i=!0):h<s&&(e=t.delta,i=!0)):(a=parseFloat(t.delta),n=parseFloat(t.sidebarMarginTop),c=(r=o-t.getStickySidebarOffset())+n,(h=r+a)<s?(e=a,i=!0):c<=s&&s<=h&&(e=s-o+n,i=!0)),i&&t.container.animate({top:e},170,function(){t.recalculate(s,t.getStickySidebarOffset(),!1)})):this.isSticky||(this.secondary.removeClass("sidebar-sticky"),this.container.css({position:"",top:""}))},recalculate:function(t,i,e){var s,o,a,n,r,h,c,d,p=this.primary,l=this.secondary,y=this.container,g=!0;this.isSticky?(s=parseFloat(this.sidebarMarginTop),o=parseFloat(this.sidebarHeight),a=parseFloat(this.primaryHeight),n=p.offset().top,r=y.offset().top,p=parseFloat(this.delta),l.addClass("sidebar-sticky"),e||cozystayInnerHeight>=o?(d=(h=n-i)+p,c=h+s,this.downThresholdSet=!1,"down"==this.previousAction?("fixed"==y.css("position")&&y.css({position:"relative",top:t-n-o+cozystayInnerHeight}),this.thresholdMin=y.offset().top-i,g=!(this.upThreshholdSet=!0)):this.upThreshholdSet&&t>this.thresholdMin?g=!1:(this.upThreshholdSet=!1,d<t?(y.css({position:"relative",top:p+"px"}),g=!1):c<=t&&t<=d&&(y.css({position:"fixed",top:i+"px"}),g=!1)),this.previousAction="up"):(c=(h=n-cozystayInnerHeight)+o,d=h+a,this.upThreshholdSet=!1,"up"==this.previousAction?("fixed"==y.css("position")&&y.css({position:"relative",top:r-n}),this.thresholdMax=parseFloat(r)+parseFloat(o)-cozystayInnerHeight,g=!(this.downThresholdSet=!0)):this.downThresholdSet&&t<this.thresholdMax?g=!1:(this.downThresholdSet=!1,c<=t&&t<=d?(y.css({position:"fixed",top:cozystayInnerHeight-o+"px"}),g=!1):d<t&&(y.css({position:"relative",top:p+"px"}),g=!1)),this.previousAction="down")):(l.removeClass("sidebar-sticky"),this.previousAction=""),g&&y.css({position:"",top:""})}};i.on("cozystay.init",function(){a.init()})}(jQuery);
