!function(a){"use strict";var e,n,r,t=a(".csvp-groups-wrapper"),o=!1,c=!1,s=t.find(".button.new-csvp-item-btn"),l={adult_number:"",child_number:"",guest_number:"",price:"",weekend_price:""},p={adult_number:"",adult_price:"",child_number:"",child_price:"",guest_number:"",price:"",weekend_adult_price:"",weekend_child_price:"",weekend_price:""},i={title:loftoceanRoomEditingVariablePrices.i18n.defaultCustomVariablePriceItemTitle,date_range:[{start_date:"",end_date:""}],enable_guest_group:"",enable_weekend_price:"",per_person:[l],nightly:[p]},d="undefined"!=typeof loftoceanRoomEditingVariablePrices&&loftoceanRoomEditingVariablePrices.hasOwnProperty("custom")&&loftoceanRoomEditingVariablePrices.custom.length?loftoceanRoomEditingVariablePrices.custom:[i],m=wp.template("loftocean-room-custom-variable-price-date-range-item"),h=wp.template("loftocean-room-custom-variable-price-item"),u=wp.template("loftocean-room-variable-prices");t.length&&((e=a(".panel-wrap.room-data-settings")).on("change","input[name=loftocean_room_price_by_people]",function(e){this.checked?(o=!0,t.find(".variable-price-by-guest.loftocean-variable-price").removeClass("hide"),t.find(".variable-price-by-room.loftocean-variable-price").addClass("hide")):(o=!1,t.find(".variable-price-by-guest.loftocean-variable-price").addClass("hide"),t.find(".variable-price-by-room.loftocean-variable-price").removeClass("hide"))}).on("change",".csvp-groups-wrapper > .checkbox-field > [type=checkbox]",function(e){c=this.checked?(a(this).parent().siblings(".csvp-item, .new-csvp-item-btn").removeClass("hide"),!0):(a(this).parent().siblings(".csvp-item, .new-csvp-item-btn").addClass("hide"),!1)}).on("click",".loftocean-variable-price tfoot .button",function(e){e.preventDefault(),e.stopPropagation();var t=a(this),i=t.data("current-index"),e=t.data("current-type"),i=isNaN(i)?0:i,e=["regular","per-person"].includes(e)?e:"regular",e=u({index:i,namePrefix:t.data("name-prefix"),type:e,byPersonData:l,byNightData:p});e.length&&(t.data("current-index",++i),t.closest("table").find("tbody").append(e))}).on("click",".loftocean-variable-price .variable-actions .button",function(e){e.preventDefault(),e.stopPropagation();e=a(this).closest("tr");e.siblings("tr").length?e.remove():e.find("input").val("")}),t.on("click",".date-range-list-wrap .date-picker",function(e){a(this).data("date-picker-inited")||a(this).datepicker({dateFormat:"yy-mm-dd"}).datepicker("show").data("date-picker-inited",!0)}).on("click",".csvp-item .csvp-item-header .csvp-item-remove",function(e){e.preventDefault(),e.stopPropagation(),a(this).closest(".csvp-item").remove()}).on("click",".add-time-slot",function(e){e.preventDefault(),e.stopPropagation();var t=a(this).closest(".date-range-list-wrap"),i=t.data("current-index"),e=m({namePrefix:t.data("name-prefix"),index:i});e&&(a(this).parent().after(e),t.data(++i))}).on("click",".delete-time-slot",function(e){e.preventDefault(),e.stopPropagation();e=a(this).parent();e.siblings(".multi-items-wrapper").length?e.remove():e.find("input").val("")}).on("keyup",".csvp-item .item-title-field input",function(e){var t=a("<div>").html(a(this).val()).text();a(this).closest(".csvp-item-content").siblings(".csvp-item-header").find(".csvp-item-title").html(t||"&nbsp;")}).on("click",".csvp-item .csvp-item-header .csvp-item-toggle.expand",function(e){e.preventDefault(),e.stopPropagation();e=a(this).closest(".csvp-item-header").siblings(".csvp-item-content");e.length&&(e.show(),a(this).addClass("hidden").siblings(".csvp-item-toggle").removeClass("hidden"))}).on("click",".csvp-item .csvp-item-header .csvp-item-toggle.fold",function(e){e.preventDefault(),e.stopPropagation();e=a(this).closest(".csvp-item-header").siblings(".csvp-item-content");e.length&&(e.hide(),a(this).addClass("hidden").siblings(".csvp-item-toggle").removeClass("hidden"))}).on("change",".enable-person-group",function(e){var t=a(this).closest(".controls-row").find(".loftocean-variable-price");this.checked?t.addClass("has-guest-group"):t.removeClass("has-guest-group")}).on("change",".enable-weekend-price",function(e){var t=a(this).closest(".controls-row").find(".loftocean-variable-price");this.checked?t.addClass("has-weekend-price"):t.removeClass("has-weekend-price")}),s.on("click",function(e){e.preventDefault(),e.stopPropagation();var t=s.data("current-index"),e=h({index:t,list:[i],priceByPersonEnabled:o,hide:!1});e&&(e=a(e),s.data("current-index",++t),s.before(e),e.find(".loftocean-variable-price tfoot .button").trigger("click"))}),o=e.find("input[name=loftocean_room_price_by_people]")[0].checked,c=a(".csvp-groups-wrapper > .checkbox-field > [type=checkbox]")[0].checked,d.length&&(n=s.data("current-index"),r=0,d.forEach(function(e){var t,i=h({index:n,list:[e],priceByPersonEnabled:o,hide:!c,hideContent:0<r});i.length&&(t=a(i),s.before(t),n++,r++,[{type:"regular",property:e.nightly,selector:".variable-price-by-room"},{type:"per_person",property:e.per_person,selector:".variable-price-by-guest"}].forEach(function(i){var a=t.find(i.selector+" tfoot .button"),n=t.find(i.selector+" tbody"),r=0;i.property.forEach(function(e,t){e=u({index:t,namePrefix:a.data("name-prefix"),type:i.type,byPersonData:e,byNightData:e});e&&(n.append(e),r++)}),a.data("current-index",r)}))}),s.data("current-index",n)),c?s.removeClass("hide"):s.addClass("hide"),t.sortable({items:"> .csvp-item",handle:".csvp-item-header"}))}(jQuery);